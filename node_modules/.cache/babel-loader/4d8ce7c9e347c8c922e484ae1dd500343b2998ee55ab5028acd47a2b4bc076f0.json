{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useCallback, useEffect, useRef, useState } from \"react\";\nexport default function useSpeech({\n  lang = \"en-US\",\n  interim = false,\n  onResult\n} = {}) {\n  _s();\n  const [listening, setListening] = useState(false);\n  const [lastError, setLastError] = useState(\"\");\n  const recogRef = useRef(null);\n  const can = typeof window !== \"undefined\" && (window.SpeechRecognition || window.webkitSpeechRecognition);\n  useEffect(() => {\n    if (!can) return;\n    const R = window.SpeechRecognition || window.webkitSpeechRecognition;\n    const rec = new R();\n    rec.lang = lang;\n    rec.interimResults = interim;\n    rec.continuous = false; // 한 문장당 1회 결과\n    rec.maxAlternatives = 1;\n    rec.onresult = e => {\n      const str = Array.from(e.results).map(r => {\n        var _r$;\n        return ((_r$ = r[0]) === null || _r$ === void 0 ? void 0 : _r$.transcript) || \"\";\n      }).join(\" \");\n      onResult === null || onResult === void 0 ? void 0 : onResult(str);\n    };\n    rec.onend = () => setListening(false);\n    rec.onerror = e => {\n      setLastError((e === null || e === void 0 ? void 0 : e.error) || \"unknown\");\n      setListening(false);\n    };\n    recogRef.current = rec;\n    return () => {\n      try {\n        rec.abort();\n      } catch {}\n    };\n  }, [can, lang, interim, onResult]);\n  const start = useCallback(() => {\n    setLastError(\"\");\n    if (!recogRef.current) return;\n    try {\n      recogRef.current.start(); // iOS는 버튼 클릭 같은 사용자 제스처 직후에만 허용\n      setListening(true);\n    } catch (e) {\n      setListening(false);\n      setLastError((e === null || e === void 0 ? void 0 : e.message) || \"start failed\");\n    }\n  }, []);\n  const stop = useCallback(() => {\n    if (!recogRef.current) return;\n    try {\n      recogRef.current.stop();\n    } catch {}\n    setListening(false);\n  }, []);\n  return {\n    canUseSpeech: !!can,\n    listening,\n    start,\n    stop,\n    lastError\n  };\n}\n_s(useSpeech, \"NcSxn75TNlarQylr5ZNJR/+8qY4=\");","map":{"version":3,"names":["useCallback","useEffect","useRef","useState","useSpeech","lang","interim","onResult","_s","listening","setListening","lastError","setLastError","recogRef","can","window","SpeechRecognition","webkitSpeechRecognition","R","rec","interimResults","continuous","maxAlternatives","onresult","e","str","Array","from","results","map","r","_r$","transcript","join","onend","onerror","error","current","abort","start","message","stop","canUseSpeech"],"sources":["/Users/evelynpark/Desktop/bell-day/who-is-going-to-bell-the-cat/src/hooks/useSpeech.js"],"sourcesContent":["import { useCallback, useEffect, useRef, useState } from \"react\";\n\nexport default function useSpeech({ lang=\"en-US\", interim=false, onResult } = {}) {\n  const [listening, setListening] = useState(false);\n  const [lastError, setLastError] = useState(\"\");\n  const recogRef = useRef(null);\n  const can = typeof window !== \"undefined\" && (\n    window.SpeechRecognition || window.webkitSpeechRecognition\n  );\n\n  useEffect(() => {\n    if (!can) return;\n    const R = window.SpeechRecognition || window.webkitSpeechRecognition;\n    const rec = new R();\n    rec.lang = lang;\n    rec.interimResults = interim;\n    rec.continuous = false;        // 한 문장당 1회 결과\n    rec.maxAlternatives = 1;\n\n    rec.onresult = (e) => {\n      const str = Array.from(e.results).map(r => r[0]?.transcript || \"\").join(\" \");\n      onResult?.(str);\n    };\n    rec.onend = () => setListening(false);\n    rec.onerror = (e) => {\n      setLastError(e?.error || \"unknown\");\n      setListening(false);\n    };\n\n    recogRef.current = rec;\n    return () => { try { rec.abort(); } catch {} };\n  }, [can, lang, interim, onResult]);\n\n  const start = useCallback(() => {\n    setLastError(\"\");\n    if (!recogRef.current) return;\n    try {\n      recogRef.current.start();    // iOS는 버튼 클릭 같은 사용자 제스처 직후에만 허용\n      setListening(true);\n    } catch (e) {\n      setListening(false);\n      setLastError(e?.message || \"start failed\");\n    }\n  }, []);\n\n  const stop = useCallback(() => {\n    if (!recogRef.current) return;\n    try { recogRef.current.stop(); } catch {}\n    setListening(false);\n  }, []);\n\n  return { canUseSpeech: !!can, listening, start, stop, lastError };\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}